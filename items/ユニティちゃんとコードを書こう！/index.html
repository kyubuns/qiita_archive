
<h1>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>

<p>この記事は、<a href="http://unityassetjp.doorkeeper.jp/events/12843" rel="nofollow noopener" target="_blank">Unity アセット真夏のアドベントカレンダー 2014 Summer！</a>17日目の記事です。<br>
前半はユニティちゃん好きな方向け、後半はUnityAsset作る方向け　と、詰め込みすぎて2段構成になっちゃいました。</p>

<h1>
<span id="ユニティちゃんとコードを書こう" class="fragment"></span><a href="#%E3%83%A6%E3%83%8B%E3%83%86%E3%82%A3%E3%81%A1%E3%82%83%E3%82%93%E3%81%A8%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%93%E3%81%86"><i class="fa fa-link"></i></a>ユニティちゃんとコードを書こう！</h1>

<p>この！ちきしょー！やめてやる！！コードを書くのなんかやめ…て…え！？見…てる？</p>

<p><a href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F6459%2F24046a51-862b-2f8d-1ec8-b971e79398f2.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=09293c2ed73f31628fa0d5137e798066" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F6459%2F24046a51-862b-2f8d-1ec8-b971e79398f2.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=09293c2ed73f31628fa0d5137e798066" alt="unity-chan1.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/6459/24046a51-862b-2f8d-1ec8-b971e79398f2.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F6459%2F24046a51-862b-2f8d-1ec8-b971e79398f2.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=4ec08242d924d40ffdc05d35ef462a8c 1x" loading="lazy"></a></p>

<p>Hierarchyウィンドウのユニティちゃんが僕を見てる？ <br>
Hierarchyウィンドウのユニティちゃんが僕を見てるぞ！ユニティちゃんが僕を見てるぞ！Hierarchyウィンドウのユニティちゃんが僕を見てるぞ！！ </p>

<p><a href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F6459%2F27b5a77e-94ff-cc96-b581-9cb6d861cb27.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=93c283a2f0ac7d0cb23c4a4f4bfc0657" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F6459%2F27b5a77e-94ff-cc96-b581-9cb6d861cb27.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=93c283a2f0ac7d0cb23c4a4f4bfc0657" alt="Unity-chan2.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/6459/27b5a77e-94ff-cc96-b581-9cb6d861cb27.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F6459%2F27b5a77e-94ff-cc96-b581-9cb6d861cb27.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=872ab91272d8716d8f99a59bef0ceb74 1x" loading="lazy"></a></p>

<p>実行中はユニティちゃんちゃんが走ってるぞ！！！よかった…UnityEditorは、まだまだ捨てたモンじゃないんだねっ！<br>
いやっほぉおおおおおおお！！！僕にはユニティちゃんちゃんがいる！！やったよUnity！！ひとりでゲーム作れるもん！！！</p>

<h1>
<span id="ということで" class="fragment"></span><a href="#%E3%81%A8%E3%81%84%E3%81%86%E3%81%93%E3%81%A8%E3%81%A7"><i class="fa fa-link"></i></a>ということで</h1>

<p>Hierarchyウィンドウからユニティちゃんが見守っていてくれるアセットを作りました。<br>
通常時は立ちモーション、実行中は走ります。<br>
また、実行中に一時停止すると走ったまま止まったりと微妙な工夫が施されています。<br>
が、それだけです。</p>

<p>AssetStore(まだ)<br>
<a href="https://github.com/kyubuns/mini_unity_chan_on_unity" rel="nofollow noopener" target="_blank">github</a></p>

<p>AssetStoreに出して「Assetの紹介！」という体で紹介しようとしたのですが、<br>
Rejectくらったので、まだAssetStoreにでてません！<br>
また出し直します！すみません！</p>

<h1>
<span id="assetを見て学ぼう" class="fragment"></span><a href="#asset%E3%82%92%E8%A6%8B%E3%81%A6%E5%AD%A6%E3%81%BC%E3%81%86"><i class="fa fa-link"></i></a>Assetを見て学ぼう！</h1>

<p>ここから後半戦です。<br>
今回のアセットのコードと共に、このユニティちゃんのアセット作るときに使ったもろもろを紹介します。</p>

<h2>
<span id="assetseditor直下には何もおかない" class="fragment"></span><a href="#assetseditor%E7%9B%B4%E4%B8%8B%E3%81%AB%E3%81%AF%E4%BD%95%E3%82%82%E3%81%8A%E3%81%8B%E3%81%AA%E3%81%84"><i class="fa fa-link"></i></a>Assets/Editor直下には何もおかない</h2>

<p><a href="https://github.com/kyubuns/mini_unity_chan_on_unity/tree/master/Assets/MiniUnityChan" rel="nofollow noopener" target="_blank">今回のディレクトリ構成</a>を見て頂くと分かるのですが、<br>
Assets/Editor<br>
ではなく、<br>
Assets/MiniUnityChan/Editor<br>
以下にコードが入るようにしています。<br>
「Editorや、Resourcesディレクトリ以下にファイルを置け」という時は、別にAssets直下じゃなくても問題無いです。<br>
なので、Assets/Editor直下にファイルを入れて「あれ！？このファイル何のAssetのやつだっけ・・・」とユーザーさんが困らないようにしましょう。</p>

<h2>
<span id="namespaceを分ける" class="fragment"></span><a href="#namespace%E3%82%92%E5%88%86%E3%81%91%E3%82%8B"><i class="fa fa-link"></i></a>namespaceを分ける</h2>

<p><a href="https://github.com/kyubuns/mini_unity_chan_on_unity/blob/master/Assets/MiniUnityChan/Editor/Core.cs" rel="nofollow noopener" target="_blank">MiniUnityChan.Core</a>を見て頂くと分かりますが、ちゃんと</p>

<div class="code-frame" data-lang="lang">
<div class="code-lang"><span class="bold">View.cs</span></div>
<div class="highlight"><pre>namespace MiniUnityChan
{
</pre></div>
</div>

<p>namespaceを分けています。<br>
Importされたプロジェクトに、既に同じ名前のクラスが存在する！とか、<br>
他のAssetと名前が衝突する！ということを避けるためです。<br>
Assetとして配布するときはやっておきましょう！</p>

<h2>
<span id="assetがどこに移動されても大丈夫なようにしておく" class="fragment"></span><a href="#asset%E3%81%8C%E3%81%A9%E3%81%93%E3%81%AB%E7%A7%BB%E5%8B%95%E3%81%95%E3%82%8C%E3%81%A6%E3%82%82%E5%A4%A7%E4%B8%88%E5%A4%AB%E3%81%AA%E3%82%88%E3%81%86%E3%81%AB%E3%81%97%E3%81%A6%E3%81%8A%E3%81%8F"><i class="fa fa-link"></i></a>Assetがどこに移動されても大丈夫なようにしておく</h2>

<p>ImportされたAssetは、使う人によってどこのディレクトリに移動されるか分かりません。<br>
（自分も、AssetStoreからImportしてきたAssetは、特定の1ディレクトリ以下にまとめるようにしています。）<br>
どこに移動されても問題無いように作っておくのが吉です。</p>

<p><a href="https://github.com/kyubuns/mini_unity_chan_on_unity/blob/master/Assets/MiniUnityChan/Editor/View.cs#L54" rel="nofollow noopener" target="_blank">MiniUnityChan.View.LoadSprite</a></p>

<div class="code-frame" data-lang="lang">
<div class="code-lang"><span class="bold">View.cs</span></div>
<div class="highlight"><pre>var spritePath = new Uri(Directory.GetFiles(Application.dataPath, spriteName, SearchOption.AllDirectories)[0]);
var projectRootPath = new Uri(Application.dataPath);
var relativeUri = projectRootPath.MakeRelativeUri(spritePath);
var loadSprite = AssetDatabase.LoadAllAssetRepresentationsAtPath(relativeUri.ToString());
</pre></div>
</div>

<p>ここのコードはちょっと面倒なことをしています。<br>
1つのファイルを読んできたいだけなのですが、<br>
Directory.GetFilesで、特定のファイル名を<a href="http://docs.unity3d.com/ScriptReference/Application-dataPath.html" rel="nofollow noopener" target="_blank">Application.dataPath</a>以下から探してきます。<br>
しかし、これによって帰ってくるのはフルパスなので、projectRootPathからの相対パスを作ってやって、やっと<a href="http://docs.unity3d.com/ScriptReference/AssetDatabase.LoadAllAssetRepresentationsAtPath.html" rel="nofollow noopener" target="_blank">AssetDatabase.LoadAllAssetRepresentationsAtPath</a>に渡すことができます。<br>
他に楽な方法があれば教えてください・・・</p>

<h2>
<span id="無理矢理windowを再描画する" class="fragment"></span><a href="#%E7%84%A1%E7%90%86%E7%9F%A2%E7%90%86window%E3%82%92%E5%86%8D%E6%8F%8F%E7%94%BB%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>無理矢理Windowを再描画する</h2>

<p>普通はこんなことしないと思うのですが・・・<br>
各種EditorWindowは、基本的に何かのイベントがあったとき（クリックされた時とか）、必要にならないとWindowの再描画は走りません。<br>
今回ユニティちゃんをアニメーションさせたかったので、HierarchyWindowを無理矢理再描画しています。<br>
<a href="http://docs.unity3d.com/412/Documentation/ScriptReference/EditorApplication.RepaintHierarchyWindow.html" rel="nofollow noopener" target="_blank">EditorApplication.RepaintHierarchyWindow</a></p>

<h2>
<span id="他のassetも見て学ぼう" class="fragment"></span><a href="#%E4%BB%96%E3%81%AEasset%E3%82%82%E8%A6%8B%E3%81%A6%E5%AD%A6%E3%81%BC%E3%81%86"><i class="fa fa-link"></i></a>他のAssetも見て学ぼう！</h2>

<p>ご存じの通り、<a href="https://www.assetstore.unity3d.com/" rel="nofollow noopener" target="_blank">AssetStore</a>にはたくさんのAssetがあります！<br>
「こういう機能を作りたいんだよなー、でもこのAssetはちょっと違うかも・・・」という時、似ているAssetを探してきてソースコードを読みあさると勉強になるのでオススメです！<br>
コードがdll化されていて読めない物もあるので、有料Assetは購入前にPackageContentsを確認するようにしましょう！</p>

<p><a href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F6459%2F5d63eac6-3b10-5bd4-781f-124cf5b99f25.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=6f9cb3fb3cdcbe1eef15b89fd7adf287" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F6459%2F5d63eac6-3b10-5bd4-781f-124cf5b99f25.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=6f9cb3fb3cdcbe1eef15b89fd7adf287" alt="Asset_Store_-_CSV_Viewer.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/6459/5d63eac6-3b10-5bd4-781f-124cf5b99f25.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F6459%2F5d63eac6-3b10-5bd4-781f-124cf5b99f25.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=c43e9be92c2fabdfd0f75c927dfa455c 1x" loading="lazy"></a></p>

<h1>
<span id="おしまい" class="fragment"></span><a href="#%E3%81%8A%E3%81%97%E3%81%BE%E3%81%84"><i class="fa fa-link"></i></a>おしまい</h1>

<p>アドベントカレンダー8/18の担当は <a href="http://twitter.com/enpel" rel="nofollow noopener" target="_blank">enpel</a> さんです、よろしくお願いします！</p>

<h1>
<span id="宣伝" class="fragment"></span><a href="#%E5%AE%A3%E4%BC%9D"><i class="fa fa-link"></i></a>宣伝</h1>

<h2>
<span id="csv-viewer" class="fragment"></span><a href="#csv-viewer"><i class="fa fa-link"></i></a>CSV Viewer</h2>

<p><a href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F6459%2Fa22888ea-729d-aa80-06f3-018fa23ccd06.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=341288d76a6d0802ec02bce4938cf666" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F6459%2Fa22888ea-729d-aa80-06f3-018fa23ccd06.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=341288d76a6d0802ec02bce4938cf666" alt="9459fabc-fffc-4c73-6a81-7fda866291a4.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/6459/a22888ea-729d-aa80-06f3-018fa23ccd06.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F6459%2Fa22888ea-729d-aa80-06f3-018fa23ccd06.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=586be34da84929c681a6e0077b49be74 1x" loading="lazy"></a></p>

<p><a href="http://qiita.com/kyubuns/items/b2dcbf9c58c5b28e0ff4" id="reference-abce667609fec51de215">宣伝記事</a><br>
<a href="https://www.assetstore.unity3d.com/en/#!/content/18424" rel="nofollow noopener" target="_blank">AssetStore</a></p>

<p>AssetStoreでCSV ViewerのAssetだしてます。<br>
10万行ぐらいあるCSVとかもサクサク動きます。<br>
GUIは基本的に描画がめちゃくちゃ重いので、画面に描画されない範囲は描画しない、とか色々頑張ってるAssetです。</p>

<h1>
<span id="関連記事" class="fragment"></span><a href="#%E9%96%A2%E9%80%A3%E8%A8%98%E4%BA%8B"><i class="fa fa-link"></i></a>関連記事</h1>

<p>せっかくなので、Unity関連で、自分が今までに書いた役に立ちそうな記事へのリンクを張っておきます。</p>

<h2>
<span id="asset配布する人向け" class="fragment"></span><a href="#asset%E9%85%8D%E5%B8%83%E3%81%99%E3%82%8B%E4%BA%BA%E5%90%91%E3%81%91"><i class="fa fa-link"></i></a>Asset配布する人向け</h2>

<ul>
<li><a href="http://d.hatena.ne.jp/kyubuns/20140615/1402825919" rel="nofollow noopener" target="_blank">Assets/Editor以下とか、Assets/Plugins/iOS以下にファイルを置くのはやめよう。</a></li>
<li><a href="http://d.hatena.ne.jp/kyubuns/20140601/1401597362" rel="nofollow noopener" target="_blank">ArgumentException: Getting control n's position in a group with only n controls when doing Repaint Aborting</a></li>
<li><a href="http://d.hatena.ne.jp/kyubuns/20140527/1401190984" rel="nofollow noopener" target="_blank">Unity EditorWindowでUndoしたいとき</a></li>
</ul>

<h2>
<span id="ios系" class="fragment"></span><a href="#ios%E7%B3%BB"><i class="fa fa-link"></i></a>iOS系</h2>

<ul>
<li><a href="http://qiita.com/kyubuns/items/6cbc982a3d96e8f4c5ce" id="reference-fbd86fbbc6800147e001">Unity iOSでURL Schemeを利用してアプリを起動できるようにする</a></li>
<li><a href="http://qiita.com/kyubuns/items/c429c0f6cbe68389f7e8" id="reference-61e116aaf65981af6527">Unity iOSでURL Schemeを使って情報を受け取る</a></li>
<li><a href="http://qiita.com/kyubuns/items/28dd316ef2415fc9a48d" id="reference-a3bb339f471b6fd54db2">Unity iOS XCodeに自動で依存ライブラリの追加する</a></li>
<li><a href="http://qiita.com/kyubuns/items/24d33044e77b9fa614b3#2-6" id="reference-55ebd2665f1dd4338cfe">Unity iOS NativePluginのコードで、ARCを利用する</a></li>
</ul>
